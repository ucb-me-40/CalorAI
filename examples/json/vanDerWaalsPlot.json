{
  "problem_title": "vanDerWaalsPlot",
  "author": "tschutzius",
  "year": "Fa25",
  "difficulty_tags": ["hard"],
  "topic": "Properties",
  "course_reference": {
    "lecture_reference": {
      "lecture_id": "1_blyiho9t",
      "subtopics": [
        {
          "key": "Fa25-L3b-6.0",
          "title": "van der Waals equation of state"
        }
      ]
    },
    "book_reference": {
      "chapter_number": 3,
      "title": "Properties of Pure Substances",
      "sections": ["Other Equations of State"]
    }
  },
  "notes": "",
  "problem_statement_raw": "Goal: Plot the isotherms at the critical point of water using pyCalor, the van der Waals equation of state, and the ideal gas equation.",
  "schematic_raw": "No schematic",
  "physical_laws_and_assumptions": "Assumptions and Approximations: Pure substance. Dependent properties only depend upon two independent properties. Physical Laws and Governing Equations: The ideal gas equation for water can be written as: $$ p = R T / v$$ where $R$ is the mass specific gas constant. The van der Waals equation is defined as: $$\\left(p + \\frac{a}{v^2} \\right) \\left(v - b \\right) = RT $$ where $p$ is pressure, $v$ is specific volume, $R$ is the specific gas constant, $T$ is temperature, and $a$ and $b$ are constants. We can write this as: $$ p  = (R T_\\text{cr} - (a/v^2) v + a b/v^2)/(v - b)$$",
  "solution_code": [
    {
      "step_name": "5. Properties",
      "code": "!pip install pyCalor\nfrom pyCalor import thermo as th\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# critical point of water\nTc_K = 647.096 # K\npc_Pa = 22.060e6 # Pa\n\n# triple point of water\nTtp_K = 273.16 # K\nptp_Pa = 611.6 # Pa\n\n# critical state of water\nstcritical = th.state('Water', p=pc_Pa/1e3, T=Tc_K, name=\"1\")\n\n# R, a, and b for the van der Waals equation of state\nR = stcritical.R_mass\nvc = stcritical.v # m^3/kg\nac = 27 * R**2 * Tc_K**2 / (64 * pc_Pa)\nbc = R * Tc_K / (8 * pc_Pa)\n\nprint(f\"R = {R:.5f} kJ/(kg K)\")\nprint(f\"v_c = {vc:.5e} m^3/kg\")\nprint(f\"a = {ac:.5f}\")\nprint(f\"b = {bc:.5e}\")"
    },
    {
      "step_name": "6. Calculations",
      "code": "def vdWeos(v, T, R, a, b):\n    \"\"\"van der Waals equation of state\"\"\"\n    # p = R*T / (v-b) - a/v^2\n    p = R * T / (v - b) - a / v**2\n    return p / 1e6 # convert to MPa\n\ndef idealeos(v, T, R):\n    \"\"\"Ideal Gas equation of state\"\"\"\n    p = R * T / v\n    return p / 1e6 # convert to MPa\n\n# Define the range of specific volume (v)\nv_min = vc * 0.95\nv_max = vc * 10\nv_range = np.linspace(v_min, v_max, 500)\n\n# Calculate pressures\np_vdw = vdWeos(v_range, Tc_K, R, ac, bc)\np_ideal = idealeos(v_range, Tc_K, R)\n\n# pyCalor data (CoolProp)\np_pycalor = [th.state('Water', v=v, T=Tc_K).p/1e6 for v in v_range]\n\n# Plotting\nfig, ax = plt.subplots(figsize=(6, 4), dpi=150)\nax.plot(v_range, p_pycalor, 'k-', label='pyCalor (CoolProp)')\nax.plot(v_range, p_vdw, 'r--', label='van der Waals')\nax.plot(v_range, p_ideal, 'b:', label='Ideal Gas')\n\n# Add critical point\nax.plot(vc, pc_Pa/1e6, 'ko', label='Critical Point')\n\n# Labeling and Formatting\nax.legend()\nax.set_title(f'Water Critical Isotherm ($T_\\text{{cr}} = {Tc_K:.2f}$ K)')\nxmin = 0.8e-3\nxmax = 1\nax.set_xlim([xmin, xmax])\nymin = 0\nymax = 25\nax.set_ylim([ymin, ymax])\nax.set_xlabel('$v$ (m$^3$/kg)')\nax.set_ylabel('$p$ (MPa)')\n\n# plt.savefig('pycalor-vdW-p-v-diagram.pdf')"
    }
  ],
  "pedagogical_summary": "We were able to plot critical temperature isotherms for water using pyCalor, the van der Waals equation of state, and the ideal gas equation. What we see is that for high values of specific volume, all three isotherms overlap, indicating that they are all valid. However, for lower specific volumes, below 0.1 m$^3$/kg the ideal gas equation significantly deviates from the other two isotherms, indicating that it is no longer valid."
}